= helpers.turbo_stream_from chat.id, 'messages'

#chat.mx-auto.bg-white.dark:bg-gray-800.shadow-lg.flex.flex-col.mt-4.max-h-full.w-full{ data: { controller: 'chat' }, class: 'h-[650px]' }
  .flex-1.overflow-y-auto.p-4.space-y-4#messages{ data: { chat_target: 'messages' }, class: 'dark:text-white' }
    - chat.messages.each do |message|
      = component "chats/message", message:, size: size
    - if disabled?
      = inline_svg 'icons/dots.svg', class: 'w-8 h-8 text-gray-500 mx-auto my-4'
  
  - if message_form.present?
    .bg-gray-100.dark:bg-gray-700.p-4.rounded-b-lg.items-center
      = form_for message_form, url: url_for(controller: "#{namespace}/chats/messages", action: :create), method: :post, html: { class: 'flex space-x-2' } do |f|
        - waiting_placeholder = t('chat.placeholders.waiting', default: I18n.t('tramway.chat.waiting_for_answer'))
        - typing_placeholder = t('chat.placeholders.typing', default: I18n.t('tramway.chat.type_your_message'))
        = f.text_field :text,
          class: 'flex-1 px-2 py-2 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white disabled:bg-gray-600',
          placeholder: message_form.disabled? ? waiting_placeholder : typing_placeholder,
          data: { chat_target: 'input' },
          disabled: message_form.disabled?

        = f.hidden_field :chat_id, value: message_form.chat_id
        = f.hidden_field :sender_type, value: message_form.sender_type
        = f.hidden_field :sender_id, value: message_form.sender_id
        - options.each do |(key, value)|
          = f.hidden_field key, value: value
        = f.submit t('actions.send'),
          class: 'bg-blue-500 hover:bg-blue-400 text-white px-4 py-2 rounded-lg cursor-pointer dark:bg-blue-600 dark:hover:bg-blue-500'
